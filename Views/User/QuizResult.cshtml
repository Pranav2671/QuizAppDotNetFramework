@model QuizAppDotNetFramework.Models.QuizResultModel

@{
    ViewBag.Title = "Quiz Result";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mt-5">
    <h2 class="text-success mb-4">Your Quiz Result</h2>

    <!-- Total Score -->
    <div class="card mb-4 p-3 shadow-sm">
        <p><strong>Total Questions:</strong> @Model.TotalQuestions</p>
        <p><strong>Correct Answers:</strong> @Model.CorrectAnswers</p>
        <p><strong>Score:</strong> @Model.Score %</p>

        @* Remarks based on score *@
        <p class="mt-2">
            @if (Model.Score >= 80)
            {
                <span class="text-success">Excellent work!</span>
            }
            else if (Model.Score >= 50)
            {
                <span class="text-warning">Good job! Keep practicing.</span>
            }
            else
            {
                <span class="text-danger">Don’t give up! Try again.</span>
            }
        </p>
    </div>

    <h3 class="mb-3">Questions and Answers</h3>

    @foreach (var detail in Model.ResultDetails)
    {
        var borderClass = detail.IsCorrect ? "border-success"
                          : (detail.YourAnswer == "Not Attempted" ? "border-warning" : "border-danger");
        var answerColor = detail.IsCorrect ? "green"
                          : (detail.YourAnswer == "Not Attempted" ? "orange" : "red");

        <div class="card mb-3 p-3 shadow-sm @borderClass">
            <p><strong>Question:</strong> @detail.QuestionText</p>
            <p>
                <strong>Your Answer:</strong>
                <span style="color:@answerColor">
                    @GetOptionText(detail, detail.YourAnswer)
                </span>
            </p>
            <p>
                <strong>Correct Answer:</strong>
                <span style="color:green">
                    @GetOptionText(detail, detail.CorrectAnswer)
                </span>
            </p>
        </div>
    }
</div>

@functions {
    // Converts option letter to actual answer text
    // Returns the text of the answer without relying on OptionA–D
    private string GetOptionText(QuizAppDotNetFramework.Models.QuizResultDetail detail, string option)
    {
        if (string.IsNullOrEmpty(option) || option == "Not Attempted")
            return "Not Attempted";

        // Option is already the answer text (or the letter). Just return it.
        return option;
    }
}


